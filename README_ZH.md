# @chaeco/route-wizard# @chaeco/route-wizard# @chaeco/route-wizard# @chaeco/route-wizard



[![NPM version](https://img.shields.io/npm/v/@chaeco/route-wizard.svg)](https://npmjs.org/package/@chaeco/route-wizard)

[![Build Status](https://img.shields.io/github/actions/workflow/status/chaeco/route-wizard/ci.yml?branch=main)](https://github.com/chaeco/route-wizard/actions)

[![Test Coverage](https://img.shields.io/badge/coverage-67.47%25-yellow.svg)](https://github.com/chaeco/route-wizard)[![NPM version](https://img.shields.io/npm/v/@chaeco/route-wizard.svg)](https://npmjs.org/package/@chaeco/route-wizard)

[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)

[![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-blue.svg)](https://www.typescriptlang.org/)[![Build Status](https://img.shields.io/github/actions/workflow/status/chaeco/route-wizard/ci.yml?branch=main)](https://github.com/chaeco/route-wizard/actions)



**åŸºäºæ–‡ä»¶çš„è‡ªåŠ¨è·¯ç”±æ³¨å†Œå™¨ï¼Œä¸º Node.js æ¡†æ¶æä¾›é›¶é…ç½®çš„è·¯ç”±ç®¡ç†ã€‚**[![Test Coverage](https://img.shields.io/badge/coverage-67.47%25-yellow.svg)](https://github.com/chaeco/route-wizard)[![NPM version](https://img.shields.io/npm/v/@chaeco/route-wizard.svg)](https://npmjs.org/package/@chaeco/route-wizard)[![NPM version](https://img.shields.io/npm/v/@chaeco/route-wizard.svg)](https://npmjs.org/package/@chaeco/route-wizard)



## âœ¨ ç‰¹æ€§[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)



- ğŸ“ **æ–‡ä»¶é©±åŠ¨è·¯ç”±**: é€šè¿‡æ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼Œé›¶é…ç½®[![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-blue.svg)](https://www.typescriptlang.org/)[![Build Status](https://img.shields.io/github/actions/workflow/status/chaeco/route-wizard/ci.yml?branch=main)](https://github.com/chaeco/route-wizard/actions)[![Build Status](https://img.shields.io/github/actions/workflow/status/chaeco/route-wizard/ci.yml?branch=main)](https://github.com/chaeco/route-wizard/actions)

- ğŸ—ï¸ **å¤šæ¡†æ¶æ”¯æŒ**: æ”¯æŒ Expressã€Koaã€Fastify ç­‰æ¡†æ¶

- ğŸ“ **å®Œæ•´ TypeScript æ”¯æŒ**: å®Œæ•´çš„ç±»å‹å®šä¹‰

- âš¡ **é«˜æ€§èƒ½**: åŒæ­¥æ‰«æï¼Œé›¶è¿è¡Œæ—¶å¼€é”€

- ğŸ¯ **çº¦å®šä¼˜äºé…ç½®**: åˆç†çš„é»˜è®¤å€¼å’Œå¹¿æ³›çš„è‡ªå®šä¹‰é€‰é¡¹**åŸºäºæ–‡ä»¶çš„è‡ªåŠ¨è·¯ç”±æ³¨å†Œå™¨ï¼Œä¸º Node.js æ¡†æ¶æä¾›é›¶é…ç½®çš„è·¯ç”±ç®¡ç†ã€‚**[![Test Coverage](https://img.shields.io/badge/coverage-67.47%25-yellow.svg)](https://github.com/chaeco/route-wizard)[![Test Coverage](https://img.shields.io/badge/coverage-47.44%25-yellow.svg)](https://github.com/chaeco/route-wizard)

- ğŸ”Œ **ä¸­é—´ä»¶æ”¯æŒ**: ä¸ºæ¯ä¸ªè·¯ç”±æ·»åŠ ä¸­é—´ä»¶

- ğŸ“Š **æ€§èƒ½ç›‘æ§**: å†…ç½®æ€§èƒ½æŒ‡æ ‡è·Ÿè¸ª



## ğŸš€ å®‰è£…## âœ¨ ç‰¹æ€§[![Codecov](https://codecov.io/gh/chaeco/route-wizard/branch/main/graph/badge.svg)](https://codecov.io/gh/chaeco/route-wizard)[![Codecov](https://codecov.io/gh/chaeco/route-wizard/branch/main/graph/badge.svg)](https://codecov.io/gh/chaeco/route-wizard)



```bash

npm install @chaeco/route-wizard

```- ğŸ“ **æ–‡ä»¶é©±åŠ¨è·¯ç”±**: é€šè¿‡æ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼Œé›¶é…ç½®[![Bundle Size](https://img.shields.io/bundlephobia/min/@chaeco/route-wizard)](https://bundlephobia.com/result?p=@chaeco/route-wizard)[![Bundle Size](https://img.shields.io/bundlephobia/min/@chaeco/route-wizard)](https://bundlephobia.com/result?p=@chaeco/route-wizard)



## ğŸ¯ å¿«é€Ÿå¼€å§‹- ğŸ—ï¸ **å¤šæ¡†æ¶æ”¯æŒ**: æ”¯æŒ Expressã€Koaã€Fastify ç­‰æ¡†æ¶



### 1. åˆ›å»ºæ§åˆ¶å™¨æ–‡ä»¶- ğŸ“ **å®Œæ•´ TypeScript æ”¯æŒ**: å®Œæ•´çš„ç±»å‹å®šä¹‰[![Dependencies](https://img.shields.io/badge/dependencies-0-brightgreen)](https://github.com/chaeco/route-wizard/blob/main/package.json)[![Dependencies](https://img.shields.io/badge/dependencies-0-brightgreen)](https://github.com/chaeco/route-wizard/blob/main/package.json)



åœ¨ `controllers` ç›®å½•ä¸‹åˆ›å»ºè·¯ç”±æ–‡ä»¶ï¼š- âš¡ **é«˜æ€§èƒ½**: åŒæ­¥æ‰«æï¼Œé›¶è¿è¡Œæ—¶å¼€é”€



```typescript- ğŸ¯ **çº¦å®šä¼˜äºé…ç½®**: åˆç†çš„é»˜è®¤å€¼å’Œå¹¿æ³›çš„è‡ªå®šä¹‰é€‰é¡¹[![License](https://img.shields.io/github/license/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/blob/main/LICENSE)[![License](https://img.shields.io/github/license/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/blob/main/LICENSE)

// controllers/users/get.ts

export default async (req, res) => {- ğŸ”Œ **ä¸­é—´ä»¶æ”¯æŒ**: ä¸ºæ¯ä¸ªè·¯ç”±æ·»åŠ ä¸­é—´ä»¶

  const users = await db.users.findMany();

  res.json(users);- ğŸ“Š **æ€§èƒ½ç›‘æ§**: å†…ç½®æ€§èƒ½æŒ‡æ ‡è·Ÿè¸ª[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)

};

```



### 2. æ³¨å†Œè·¯ç”±## ğŸš€ å®‰è£…[![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-blue.svg)](https://www.typescriptlang.org/)[![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-blue.svg)](https://www.typescriptlang.org/)



```typescript

import express from 'express';

import { registerRoutes } from '@chaeco/route-wizard';```bash[![GitHub issues](https://img.shields.io/github/issues/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/issues)[![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-blue.svg)](https://www.typescriptlang.org/)



const app = express();npm install @chaeco/route-wizard

registerRoutes(app, {

  dir: './controllers',```[![GitHub pull requests](https://img.shields.io/github/issues-pr/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/pulls)[![GitHub issues](https://img.shields.io/github/issues/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/issues)

  prefix: '/api',

});

```

## ğŸ¯ å¿«é€Ÿå¼€å§‹[![Last commit](https://img.shields.io/github/last-commit/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/commits/main)[![GitHub pull requests](https://img.shields.io/github/issues-pr/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/pulls)

### 3. ä½ çš„è·¯ç”±å·²å‡†å¤‡å¥½



```text

GET  /api/users### 1. åˆ›å»ºæ§åˆ¶å™¨æ–‡ä»¶[![Last commit](https://img.shields.io/github/last-commit/chaeco/route-wizard)](https://github.com/chaeco/route-wizard/commits/main)

POST /api/users

GET  /api/users/:id

```

åœ¨ `controllers` ç›®å½•ä¸‹åˆ›å»ºè·¯ç”±æ–‡ä»¶ï¼š**åŸºäºæ–‡ä»¶çš„è‡ªåŠ¨è·¯ç”±æ³¨å†Œå™¨ï¼Œä¸º Node.js æ¡†æ¶æä¾›é›¶é…ç½®çš„è·¯ç”±ç®¡ç†ã€‚åœæ­¢æ‰‹åŠ¨æ³¨å†Œè·¯ç”±ï¼Œè®©ä½ çš„æ–‡ä»¶ç»“æ„ä¸ºä½ å·¥ä½œï¼**

## ğŸ“ è·¯ç”±æ–‡ä»¶çº¦å®š



æ”¯æŒä¸¤ç§è·¯ç”±æ–¹å¼ï¼š

```typescriptåŸºäºæ–‡ä»¶çš„è‡ªåŠ¨è·¯ç”±æ³¨å†Œå™¨ï¼Œä¸º Node.js æ¡†æ¶æä¾›é›¶é…ç½®çš„è·¯ç”±ç®¡ç†ã€‚åœæ­¢æ‰‹åŠ¨æ³¨å†Œè·¯ç”±ï¼Œè®©ä½ çš„æ–‡ä»¶ç»“æ„ä¸ºä½ å·¥ä½œï¼

### æ–¹å¼ä¸€ï¼šåŸºäºæ–‡ä»¶å¤¹

// controllers/users/get.ts

```text

controllers/export default async (req, res) => {## âœ¨ ç‰¹æ€§

â”œâ”€â”€ users/

â”‚   â”œâ”€â”€ get.ts        # GET /users  const users = await db.users.findMany();

â”‚   â”œâ”€â”€ post.ts       # POST /users

â”‚   â””â”€â”€ [id]/  res.json(users);## âœ¨ ç‰¹æ€§

â”‚       â””â”€â”€ get.ts    # GET /users/:id

```};



### æ–¹å¼äºŒï¼šåŸºäºæ–‡ä»¶å```- ğŸ“ **æ–‡ä»¶é©±åŠ¨è·¯ç”±**: é€šè¿‡æ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼Œé›¶é…ç½®



```text

controllers/

â”œâ”€â”€ users.get.ts           # GET /users### 2. æ³¨å†Œè·¯ç”±- ğŸ—ï¸ **å¤šæ¡†æ¶æ”¯æŒ**: å¯æ‰©å±•è®¾è®¡ï¼Œæ”¯æŒ Expressã€Koaã€Fastify å’Œ NestJS- ğŸ“ **æ–‡ä»¶é©±åŠ¨è·¯ç”±**: é€šè¿‡æ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼Œé›¶é…ç½®

â”œâ”€â”€ users.post.ts          # POST /users

â”œâ”€â”€ users.[id].get.ts      # GET /users/:id

```

```typescript- ğŸ“ **å®Œæ•´ TypeScript æ”¯æŒ**: å®Œæ•´çš„ç±»å‹å®šä¹‰ï¼Œæä¾›æ›´å¥½çš„å¼€å‘ä½“éªŒ- ğŸ—ï¸ **å¤šæ¡†æ¶æ”¯æŒ**: å¯æ‰©å±•è®¾è®¡ï¼Œæ”¯æŒ Expressã€Koaã€Hoa.jsã€Honoã€Fastify å’Œ NestJS

## ğŸ”§ ä¸­é—´ä»¶æ”¯æŒ

import express from 'express';

```typescript

// controllers/users/get.tsimport { registerRoutes } from '@chaeco/route-wizard';- âš¡ **é«˜æ€§èƒ½**: åŒæ­¥æ‰«æï¼Œé›¶è¿è¡Œæ—¶å¼€é”€- ğŸ“ **å®Œæ•´ TypeScript æ”¯æŒ**: å®Œæ•´çš„ç±»å‹å®šä¹‰ï¼Œæä¾›æ›´å¥½çš„å¼€å‘ä½“éªŒ

const authenticate = (req, res, next) => {

  if (!req.headers.authorization) {

    return res.status(401).json({ error: 'Unauthorized' });

  }const app = express();- ğŸ§© **æ¡†æ¶æ— å…³**: é€‚ç”¨äºä»»ä½•æ”¯æŒè·¯ç”±æ³¨å†Œçš„ Node.js æ¡†æ¶- âš¡ **é«˜æ€§èƒ½**: åŒæ­¥æ‰«æï¼Œé›¶è¿è¡Œæ—¶å¼€é”€

  next();

};registerRoutes(app, {



export default {  dir: './controllers',- ğŸ¯ **çº¦å®šä¼˜äºé…ç½®**: åˆç†çš„é»˜è®¤å€¼å’Œå¹¿æ³›çš„è‡ªå®šä¹‰é€‰é¡¹- ğŸ§© **æ’ä»¶æ¶æ„**: æ˜“äºæ‰©å±•ï¼Œæ”¯æŒä¸ºæ–°æ¡†æ¶åˆ›å»ºè‡ªå®šä¹‰é€‚é…å™¨

  handler: async (req, res) => {

    const users = await db.users.findMany();  prefix: '/api',

    res.json(users);

  },});- ğŸ›¡ï¸ **ç”Ÿäº§å°±ç»ª**: å…¨é¢çš„æµ‹è¯•è¦†ç›–ç‡å’Œç”Ÿäº§ç¯å¢ƒéªŒè¯- ğŸ¯ **çº¦å®šä¼˜äºé…ç½®**: åˆç†çš„é»˜è®¤å€¼å’Œå¹¿æ³›çš„è‡ªå®šä¹‰é€‰é¡¹

  middlewares: [authenticate],

};```

```

- ğŸ”„ **åŠ¨æ€å‚æ•°**: æ”¯æŒåµŒå¥—å’Œå¯é€‰å‚æ•°- ğŸ›¡ï¸ **ç”Ÿäº§å°±ç»ª**: å…¨é¢çš„æµ‹è¯•è¦†ç›–ç‡å’Œç”Ÿäº§ç¯å¢ƒéªŒè¯

## ğŸ“Š æ€§èƒ½ç›‘æ§

### 3. è·¯ç”±å·²å°±ç»ª

```typescript

import { PerformanceMonitor, createRouteWizard } from '@chaeco/route-wizard';- ğŸ”„ **åŠ¨æ€å‚æ•°**: æ”¯æŒåµŒå¥—å’Œå¯é€‰å‚æ•°



// æ–¹å¼ 1: ä½¿ç”¨ PerformanceMonitor```

const monitor = new PerformanceMonitor();

registerRoutes(app, {GET  /api/users## ğŸš€ å®‰è£…

  dir: './controllers',

  performanceMonitor: monitor,POST /api/users

});

```## ğŸš€ å®‰è£…

const metrics = monitor.getMetrics();

console.log(`Route scan time: ${metrics.routeScanTime}ms`);



// æ–¹å¼ 2: ä½¿ç”¨è·¯ç”±å‘å¯¼## ğŸ“ æ–‡ä»¶çº¦å®š```bash

const wizard = createRouteWizard({

  dir: './controllers',

  enableMonitoring: true,

});æ”¯æŒä¸¤ç§è·¯ç”±æ–¹å¼ï¼šnpm install @chaeco/route-wizard```bash



wizard.register(app);

console.log(wizard.getMetrics());

```### åŸºäºæ–‡ä»¶å¤¹```npm install @chaeco/route-wizard



## ğŸ“š API å‚è€ƒ



### registerRoutes(app, options)``````



#### å‚æ•°controllers/



- `app`: æ¡†æ¶åº”ç”¨å®ä¾‹â”œâ”€â”€ users/## ğŸ¯ å¿«é€Ÿå¼€å§‹

- `options`: é…ç½®é€‰é¡¹

â”‚   â”œâ”€â”€ get.ts        # GET /users

#### é…ç½®é€‰é¡¹

â”‚   â”œâ”€â”€ post.ts       # POST /users## ğŸ¯ å¿«é€Ÿå¼€å§‹

- `dir` (string): æ§åˆ¶å™¨ç›®å½•è·¯å¾„

- `prefix` (string): è·¯ç”±å‰ç¼€â”‚   â””â”€â”€ [id]/

- `logEnabled` (boolean): æ˜¯å¦å¯ç”¨æ—¥å¿— (é»˜è®¤: true)

- `separator` (string): æ–‡ä»¶ååˆ†éš”ç¬¦ (é»˜è®¤: '.')â”‚       â””â”€â”€ get.ts    # GET /users/:id### 1. åˆ›å»ºæ§åˆ¶å™¨æ–‡ä»¶

- `maxDepth` (number): æœ€å¤§è·¯ç”±æ·±åº¦

- `performanceMonitor` (PerformanceMonitor): æ€§èƒ½ç›‘æ§å™¨å®ä¾‹```



### createRouteWizard(options)### 1. åˆ›å»ºæ§åˆ¶å™¨æ–‡ä»¶



åˆ›å»ºä¸€ä¸ªå…·æœ‰æ€§èƒ½ç›‘æ§çš„è·¯ç”±å‘å¯¼ã€‚### åŸºäºæ–‡ä»¶å



#### è¿”å›å€¼åœ¨ `controllers` ç›®å½•ä¸‹åˆ›å»ºè·¯ç”±æ–‡ä»¶ï¼š



- `register(app)`: æ³¨å†Œè·¯ç”±```

- `getMetrics()`: è·å–æ€§èƒ½æŒ‡æ ‡

- `getSummary()`: è·å–æŒ‡æ ‡æ€»ç»“controllers/åœ¨ `controllers` ç›®å½•ä¸‹åˆ›å»ºè·¯ç”±æ–‡ä»¶ï¼š



### PerformanceMonitorâ”œâ”€â”€ users.get.ts           # GET /users



#### å…¬å¼€æ–¹æ³•â”œâ”€â”€ users.post.ts          # POST /users```typescript



- `recordRouteScan(duration: number)`: è®°å½•è·¯ç”±æ‰«ææ—¶é•¿â”œâ”€â”€ users.[id].get.ts      # GET /users/:id

- `recordRequest(responseTime: number)`: è®°å½•è¯·æ±‚å“åº”æ—¶é—´

- `recordCacheHit()`: è®°å½•ç¼“å­˜å‘½ä¸­```// controllers/users/get.ts```typescript

- `recordCacheMiss()`: è®°å½•ç¼“å­˜æœªå‘½ä¸­

- `getMetrics()`: è·å–å½“å‰æŒ‡æ ‡

- `getMetricsSummary()`: è·å–æ ¼å¼åŒ–æ€»ç»“

## ğŸ”§ ä¸­é—´ä»¶æ”¯æŒexport default async (req, res) => {// controllers/users/get.ts

## ğŸ“„ è®¸å¯è¯



MIT Â© [chaeco](https://github.com/chaeco)

```typescript  const users = await db.users.findMany();export default async (req, res) => {

// controllers/users/get.ts

const authenticate = (req, res, next) => {  res.json(users);  const users = await db.users.findMany();

  if (!req.headers.authorization) {

    return res.status(401).json({ error: 'Unauthorized' });};  res.json(users);

  }

  next();};

};

// controllers/users/post.ts

export default {

  handler: async (req, res) => {export default async (req, res) => {// controllers/users/post.ts

    const users = await db.users.findMany();

    res.json(users);  const user = await db.users.create({ data: req.body });export default async (req, res) => {

  },

  middlewares: [authenticate],  res.json(user);  const user = await db.users.create({ data: req.body });

};

```};  res.json(user);



## ğŸ“Š æ€§èƒ½ç›‘æ§};



```typescript// controllers/users/[id]/get.ts

import { PerformanceMonitor, createRouteWizard } from '@chaeco/route-wizard';

export default async (req, res) => {// controllers/users/[id]/get.ts

// æ–¹å¼ 1: ä½¿ç”¨ PerformanceMonitor

const monitor = new PerformanceMonitor();  const user = await db.users.findUnique({export default async (req, res) => {

registerRoutes(app, {

  dir: './controllers',    where: { id: req.params.id },  const user = await db.users.findUnique({

  performanceMonitor: monitor,

});  });    where: { id: req.params.id },



const metrics = monitor.getMetrics();  res.json(user);  });

console.log(`Route scan time: ${metrics.routeScanTime}ms`);

};  res.json(user);

// æ–¹å¼ 2: ä½¿ç”¨è·¯ç”±å‘å¯¼

const wizard = createRouteWizard({```};

  dir: './controllers',

  enableMonitoring: true,```

});

### 2. æ³¨å†Œè·¯ç”±

wizard.register(app);

console.log(wizard.getMetrics());### 2. æ³¨å†Œè·¯ç”±

```

```typescript

## ğŸ“š API å‚è€ƒ

import express from 'express';```typescript

### `registerRoutes(app, options)`

import { registerRoutes } from '@chaeco/route-wizard';import express from 'express';

#### å‚æ•°

import { registerRoutes } from '@chaeco/route-wizard';

- `app`: æ¡†æ¶åº”ç”¨å®ä¾‹

- `options`: é…ç½®é€‰é¡¹const app = express();



#### é€‰é¡¹app.use(express.json());const app = express();



- `dir` (string): æ§åˆ¶å™¨ç›®å½•è·¯å¾„app.use(express.json());

- `prefix` (string): è·¯ç”±å‰ç¼€

- `logEnabled` (boolean): æ˜¯å¦å¯ç”¨æ—¥å¿— (é»˜è®¤: `true`)// æ³¨å†Œè·¯ç”± - å°±æ˜¯è¿™ä¹ˆç®€å•ï¼

- `separator` (string): æ–‡ä»¶ååˆ†éš”ç¬¦ (é»˜è®¤: `'.'`)

- `maxDepth` (number): æœ€å¤§è·¯ç”±æ·±åº¦registerRoutes(app, {// æ³¨å†Œè·¯ç”± - å°±æ˜¯è¿™ä¹ˆç®€å•ï¼

- `performanceMonitor` (PerformanceMonitor): æ€§èƒ½ç›‘æ§å™¨å®ä¾‹

  dir: './controllers',registerRoutes(app, {

### `createRouteWizard(options)`

  prefix: '/api', // å¯é€‰  dir: './controllers',

åˆ›å»ºä¸€ä¸ªå…·æœ‰æ€§èƒ½ç›‘æ§çš„è·¯ç”±å‘å¯¼ã€‚

});  prefix: '/api', // å¯é€‰

#### è¿”å›

});

- `register(app)`: æ³¨å†Œè·¯ç”±

- `getMetrics()`: è·å–æ€§èƒ½æŒ‡æ ‡app.listen(3000, () => {

- `getSummary()`: è·å–æŒ‡æ ‡æ€»ç»“

  console.log('æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000');app.listen(3000, () => {

### `PerformanceMonitor`

});  console.log('æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000');

#### æ–¹æ³•

```});

- `recordRouteScan(duration: number)`: è®°å½•è·¯ç”±æ‰«ææ—¶é•¿

- `recordRequest(responseTime: number)`: è®°å½•è¯·æ±‚å“åº”æ—¶é—´```

- `recordCacheHit()`: è®°å½•ç¼“å­˜å‘½ä¸­

- `recordCacheMiss()`: è®°å½•ç¼“å­˜æœªå‘½ä¸­### 3. ä½ çš„è·¯ç”±å·²å°±ç»ª

- `getMetrics()`: è·å–å½“å‰æŒ‡æ ‡

- `getMetricsSummary()`: è·å–æ ¼å¼åŒ–æ€»ç»“### 3. ä½ çš„è·¯ç”±å·²å°±ç»ª



## ğŸ“„ è®¸å¯è¯```text



MIT Â© [chaeco](https://github.com/chaeco)GET    /api/users          # è·å–æ‰€æœ‰ç”¨æˆ·```text


POST   /api/users          # åˆ›å»ºç”¨æˆ·GET    /api/users          # è·å–æ‰€æœ‰ç”¨æˆ·

GET    /api/users/:id      # æ ¹æ®IDè·å–ç”¨æˆ·POST   /api/users          # åˆ›å»ºç”¨æˆ·

PUT    /api/users/:id      # æ›´æ–°ç”¨æˆ·GET    /api/users/:id      # æ ¹æ®IDè·å–ç”¨æˆ·

DELETE /api/users/:id      # åˆ é™¤ç”¨æˆ·PUT    /api/users/:id      # æ›´æ–°ç”¨æˆ·

```DELETE /api/users/:id      # åˆ é™¤ç”¨æˆ·

```

## ğŸ“ æ–‡ä»¶çº¦å®š

## ğŸ“ æ–‡ä»¶çº¦å®š

Route-wizard æ”¯æŒæ–‡ä»¶å¤¹å¼å’Œæ–‡ä»¶ååµŒå…¥å¼ä¸¤ç§è·¯ç”±æ–¹å¼ï¼ŒåŒæ—¶ä¿æŒå‘åå…¼å®¹æ€§ï¼š

Route-wizard ä½¿ç”¨æ¸…æ™°ç›´è§‚çš„æ–‡ä»¶ç»“æ„ï¼š

### æ–‡ä»¶å¤¹å¼ï¼ˆä¼ ç»Ÿï¼‰

```text

```textcontrollers/

controllers/â”œâ”€â”€ users/

â”œâ”€â”€ users/â”‚   â”œâ”€â”€ get.ts              # GET /users

â”‚   â”œâ”€â”€ get.ts              # GET /usersâ”‚   â”œâ”€â”€ post.ts             # POST /users

â”‚   â”œâ”€â”€ post.ts             # POST /usersâ”‚   â””â”€â”€ [id]/

â”‚   â””â”€â”€ [id]/â”‚       â”œâ”€â”€ get.ts          # GET /users/:id

â”‚       â”œâ”€â”€ get.ts          # GET /users/:idâ”‚       â”œâ”€â”€ put.ts          # PUT /users/:id

â”‚       â”œâ”€â”€ put.ts          # PUT /users/:idâ”‚       â””â”€â”€ delete.ts       # DELETE /users/:id

â”‚       â””â”€â”€ delete.ts       # DELETE /users/:idâ”œâ”€â”€ users/

â”œâ”€â”€ users/â”‚   â””â”€â”€ [userId]/

â”‚   â””â”€â”€ [userId]/â”‚       â””â”€â”€ posts/

â”‚       â””â”€â”€ posts/â”‚           â”œâ”€â”€ get.ts              # GET /users/:userId/posts

â”‚           â”œâ”€â”€ get.ts              # GET /users/:userId/postsâ”‚           â””â”€â”€ [postId]/

â”‚           â””â”€â”€ [postId]/â”‚               â””â”€â”€ get.ts          # GET /users/:userId/posts/:postId

â”‚               â””â”€â”€ get.ts          # GET /users/:userId/posts/:postIdâ””â”€â”€ search/

â””â”€â”€ search/    â””â”€â”€ [[query]]/

    â””â”€â”€ [[query]]/        â””â”€â”€ get.ts                  # GET /search/:query?

        â””â”€â”€ get.ts                  # GET /search/:query?```

```

### å‚æ•°ç±»å‹

### æ–‡ä»¶åå¼ï¼ˆæ¨èç”¨äºæ·±å±‚åµŒå¥—ï¼‰

- `[param]` â†’ `:param` (å¿…éœ€å‚æ•°)

```text- `[[param]]` â†’ `:param?` (å¯é€‰å‚æ•°)

controllers/

â”œâ”€â”€ users.get.ts            # GET /users## ğŸ”§ é«˜çº§ç”¨æ³•

â”œâ”€â”€ users.post.ts           # POST /users

â”œâ”€â”€ users.[id].get.ts       # GET /users/:id### å¤šå‚æ•°

â”œâ”€â”€ users.[id].put.ts       # PUT /users/:id

â”œâ”€â”€ users.[id].delete.ts    # DELETE /users/:id```typescript

â”œâ”€â”€ users.[userId].posts.get.ts          # GET /users/:userId/posts// controllers/users/[userId]/posts/[postId]/get.ts

â”œâ”€â”€ users.[userId].posts.[postId].get.ts # GET /users/:userId/posts/:postIdexport default async (req, res) => {

â””â”€â”€ search.[[query]].get.ts               # GET /search/:query?  const { userId, postId } = req.params;

```  const post = await db.posts.findFirst({

    where: {

### å‚æ•°ç±»å‹      id: parseInt(postId),

      userId: parseInt(userId),

- `[param]` â†’ `:param` (å¿…éœ€å‚æ•°)    },

- `[[param]]` â†’ `:param?` (å¯é€‰å‚æ•°)  });

  res.json({ post });

## ğŸ”§ é«˜çº§ç”¨æ³•};

```

### è‡ªå®šä¹‰åˆ†éš”ç¬¦

### å¯é€‰å‚æ•°

ä½ å¯ä»¥ä¸ºæ–‡ä»¶åè·¯ç”±è‡ªå®šä¹‰åˆ†éš”ç¬¦ï¼š

```typescript

```typescript// controllers/search/[[query]]/get.ts

registerRoutes(app, {export default async (req, res) => {

  dir: './controllers',  const { query } = req.params

  separator: '_', // ä½¿ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ç‚¹

});  if (query) {

```    const results = await searchDatabase(query)

    res.json({ query, results })

ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”ç¬¦ï¼š  } else {

â”‚   â”œâ”€â”€ get-orders.js

```textâ”‚   â””â”€â”€ post-orders.js

controllers/â””â”€â”€ get-health.js

â”œâ”€â”€ api_users.get.ts        # GET /api/users```

â”œâ”€â”€ users_[id].get.ts       # GET /users/:id

â””â”€â”€ users_[id]_posts.get.ts # GET /users/:id/postsè¿™å°†ç”Ÿæˆä»¥ä¸‹è·¯ç”±ï¼š

```

- `POST /auth/login`

### æ·±åº¦é™åˆ¶- `POST /auth/register`

- `POST /auth/logout`

é™åˆ¶è·¯ç”±çš„æœ€å¤§æ·±åº¦ä»¥é˜²æ­¢è¿‡äºå¤æ‚çš„ URLï¼š- `GET /users/profile`

- `PUT /users/update-profile`

```typescript- `GET /users` (get-users.js)

registerRoutes(app, {- `DELETE /users/user` (delete-user.js)

  dir: './controllers',- `GET /products`

  maxDepth: 3, // æœ€å¤š 3 ä¸ªè·¯å¾„æ®µ- `POST /products`

});- `GET /products/product`

```- `PUT /products/product`

- `GET /orders`

è¶…è¿‡æ·±åº¦é™åˆ¶çš„è·¯ç”±å°†è¢«å¿½ç•¥ã€‚- `POST /orders`

- `GET /health`

### å¤šä¸ªå‚æ•°

## API

```typescript

// controllers/users/[userId]/posts/[postId]/get.ts### `scanRoutes(options)`

export default async (req, res) => {

  const { userId, postId } = req.params;æ‰«æè·¯ç”±ç›®å½•å¹¶è¿”å›è·¯ç”±é…ç½®æ•°ç»„ã€‚

  const post = await db.posts.findFirst({

    where: {#### scanRoutes å‚æ•°

      id: parseInt(postId),

      userId: parseInt(userId),| å‚æ•°         | ç±»å‹      | æè¿°                 | é»˜è®¤å€¼            |

    },| ------------ | --------- | -------------------- | ----------------- |

  });| `dir`        | `string`  | æ§åˆ¶å™¨ç›®å½•è·¯å¾„       | `'./controllers'` |

  res.json({ post });| `prefix`     | `string`  | ä¸ºæ‰€æœ‰è·¯ç”±æ·»åŠ çš„å‰ç¼€ | `''`              |

};| `logEnabled` | `boolean` | æ˜¯å¦å¯ç”¨æ—¥å¿—è¾“å‡º     | `true`            |

```

#### è¿”å›

### å¯é€‰å‚æ•°

`RouteConfig[]` - è·¯ç”±é…ç½®æ•°ç»„

```typescript

// controllers/search/[[query]]/get.ts#### scanRoutes ç¤ºä¾‹

export default async (req, res) => {

  const { query } = req.params;```typescript

import { scanRoutes } from '@chaeco/route-wizard';

  if (query) {

    const results = await searchDatabase(query);const routes = scanRoutes({

    res.json({ query, results });  dir: './routes',

  } else {  prefix: '/api',

    res.json({ message: 'æœç´¢ç«¯ç‚¹ - æ·»åŠ æŸ¥è¯¢å‚æ•°' });  logEnabled: false,

  }});

};

```console.log(routes);

// [

### æ¡†æ¶æ”¯æŒ//   { method: 'GET', path: '/api/users', handler: [Function] },

//   { method: 'POST', path: '/api/users', handler: [Function] },

Route-wizard æ”¯æŒå¤šç§æ¡†æ¶ï¼š//   ...

// ]

```typescript```

// Express

import express from 'express';### `registerRoutes(app, options)`

import { registerRoutes } from '@chaeco/route-wizard';

æ‰«æè·¯ç”±ç›®å½•å¹¶ç›´æ¥æ³¨å†Œåˆ°åº”ç”¨å®ä¾‹ã€‚

const app = express();

registerRoutes(app, { dir: './controllers' });#### registerRoutes å‚æ•°



// Koa| å‚æ•°         | ç±»å‹      | æè¿°                       | é»˜è®¤å€¼            |

import Koa from 'koa';| ------------ | --------- | -------------------------- | ----------------- |

import { registerRoutes } from '@chaeco/route-wizard';| `app`        | `any`     | åº”ç”¨å®ä¾‹ï¼ˆExpressã€Koaç­‰ï¼‰ | -                 |

| `dir`        | `string`  | æ§åˆ¶å™¨ç›®å½•è·¯å¾„             | `'./controllers'` |

const app = new Koa();| `prefix`     | `string`  | ä¸ºæ‰€æœ‰è·¯ç”±æ·»åŠ çš„å‰ç¼€       | `''`              |

registerRoutes(app, { dir: './controllers' });| `logEnabled` | `boolean` | æ˜¯å¦å¯ç”¨æ—¥å¿—è¾“å‡º           | `true`            |



// Fastify#### registerRoutes ç¤ºä¾‹

import fastify from 'fastify';

import { registerRoutes } from '@chaeco/route-wizard';```typescript

import { registerRoutes } from '@chaeco/route-wizard';

const app = fastify();

registerRoutes(app, { dir: './controllers' });registerRoutes(app, {

```  dir: './routes',

  prefix: '/api',

## ğŸ“š API å‚è€ƒ  logEnabled: false,

});

### `registerRoutes(app, options)````



å‘åº”ç”¨æ³¨å†Œè·¯ç”±ã€‚## è´¡çŒ®æŒ‡å—



#### å‚æ•°æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚å¯¹äºé‡å¤§æ›´æ”¹ï¼Œè¯·å…ˆæ‰“å¼€ issue è®¨è®ºæ‚¨æƒ³è¦æ›´æ”¹çš„å†…å®¹ã€‚



- `app`: æ¡†æ¶åº”ç”¨å®ä¾‹ï¼ˆExpressã€Koaã€Fastify ç­‰ï¼‰### å¼€å‘è®¾ç½®

- `options`: é…ç½®é€‰é¡¹

```bash

#### é€‰é¡¹# å…‹éš†ä»“åº“

git clone https://github.com/chaeco/route-wizard.git

- `dir` (string): æ§åˆ¶å™¨ç›®å½•è·¯å¾„ï¼ˆé»˜è®¤ï¼š`'./controllers'`ï¼‰cd route-wizard

- `prefix` (string): è·¯ç”±å‰ç¼€ï¼ˆé»˜è®¤ï¼š`''`ï¼‰

- `logEnabled` (boolean): æ˜¯å¦å¯ç”¨æ—¥å¿—ï¼ˆé»˜è®¤ï¼š`true`ï¼‰# å®‰è£…ä¾èµ–

- `separator` (string): æ–‡ä»¶ååˆ†éš”ç¬¦ï¼ˆé»˜è®¤ï¼š`'.'`ï¼‰npm install

- `maxDepth` (number): æœ€å¤§è·¯ç”±æ·±åº¦ï¼ˆé»˜è®¤ï¼š`10`ï¼‰

# è¿è¡Œæµ‹è¯•

#### ç¤ºä¾‹npm test



```typescript# è¿è¡Œå¸¦è¦†ç›–ç‡çš„æµ‹è¯•

registerRoutes(app, {npm run test:coverage

  dir: './routes',

  prefix: '/api',# æ„å»ºé¡¹ç›®

  separator: '_',npm run build

  maxDepth: 5,

  logEnabled: true,# è¿è¡Œä»£ç æ£€æŸ¥

});npm run lint

``````



## ğŸ“„ è®¸å¯è¯## ç¤ºä¾‹



MIT Â© [chaeco](https://github.com/chaeco)æŸ¥çœ‹ `examples/` ç›®å½•ä¸­çš„å®Œæ•´å·¥ä½œåº”ç”¨ç¨‹åºï¼Œæ¼”ç¤ºäº† route-wizard ä¸ä¸åŒæ¡†æ¶çš„é›†æˆï¼š



## ğŸ¤ è´¡çŒ®æŒ‡å—- **[Express.js ç¤ºä¾‹](examples/express-app/)** - ä¼ ç»Ÿ Express.js é›†æˆ

- **[Koa.js ç¤ºä¾‹](examples/koa-app/)** - ä¸‹ä¸€ä»£æ¡†æ¶ï¼Œæ”¯æŒ async/await æ¨¡å¼

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚å¯¹äºé‡å¤§æ›´æ”¹ï¼Œè¯·å…ˆæ‰“å¼€ issue è®¨è®ºæ‚¨æƒ³è¦æ›´æ”¹çš„å†…å®¹ã€‚- **[Fastify ç¤ºä¾‹](examples/fastify-app/)** - é«˜æ€§èƒ½æ¡†æ¶ï¼Œæ”¯æŒæ¨¡å¼éªŒè¯

- **[Hono ç¤ºä¾‹](examples/hono-app/)** - è½»é‡çº§æ¡†æ¶ï¼Œé€‚ç”¨äºè¾¹ç¼˜è®¡ç®—å’Œå¤šç§è¿è¡Œæ—¶

### å¼€å‘è®¾ç½®

æ¯ä¸ªç¤ºä¾‹éƒ½åŒ…å«ï¼š

```bash

# å…‹éš†ä»“åº“- å®Œæ•´çš„é¡¹ç›®è®¾ç½®ï¼ŒåŒ…æ‹¬ package.json

git clone https://github.com/chaeco/route-wizard.git- ç¤ºä¾‹æ§åˆ¶å™¨ï¼Œæ¼”ç¤ºä¸åŒçš„ HTTP æ–¹æ³•

cd route-wizard- é…ç½®ç¤ºä¾‹

- å¼€å‘å’Œç”Ÿäº§è„šæœ¬

# å®‰è£…ä¾èµ–- åŒ…å«è¯¦ç»†è®¾ç½®è¯´æ˜çš„ README

npm install

## è®¸å¯è¯

# è¿è¡Œæµ‹è¯•

npm testMIT


# è¿è¡Œå¸¦è¦†ç›–ç‡çš„æµ‹è¯•
npm run test:coverage

# æ„å»ºé¡¹ç›®
npm run build

# è¿è¡Œä»£ç æ£€æŸ¥
npm run lint
```
